%   RAO_TABLE       Rao's test's statistical table.
%
%       call:   P_VALUE = RAO_TABLE(U,N).
%       does:   Gives the p value (the probability that the data
%               generating the statistic U, of size n, would be uniform)

% directional statistics package
% Dec-2001 ES

function p_value = rao_table(U,n);

rst_table=[
0 90  95 100  105 110  115 120  125 130  135 140  145 150  155 160  165 170  175 180  
4 0.69  0.65 0.60  0.56 0.51  0.47 0.43  0.39 0.34  0.30 0.27  0.23 0.20  0.17 0.14  0.11 0.09  0.08 0.06  
5 0.76  0.71 0.67  0.62 0.57  0.51 0.46  0.41 0.36  0.31 0.27  0.23 0.20  0.17 0.14  0.12 0.09  0.08 0.06  
6 0.80  0.76 0.71  0.66 0.60  0.54 0.49  0.43 0.38  0.33 0.28  0.24 0.20  0.16 0.13  0.11 0.08  0.07 0.05  
7 0.84  0.79 0.74  0.69 0.63  0.57 0.51  0.45 0.39  0.34 0.29  0.24 0.20  0.16 0.13  0.10 0.08  0.06 0.04  
8 0.87  0.82 0.78  0.72 0.66  0.60 0.53  0.47 0.41  0.35 0.29  0.24 0.19  0.15 0.12  0.09 0.07  0.05 0.04  
9 0.89  0.85 0.80  0.75 0.68  0.62 0.55  0.48 0.42  0.35 0.29  0.24 0.19  0.15 0.11  0.09 0.06  0.05 0.03  
10 0.91  0.87 0.82  0.77 0.71  0.64 0.57  0.49 0.42  0.36 0.29  0.23 0.19  0.14 0.11  0.08 0.06  0.04 0.03  
11 0.92  0.89 0.84  0.79 0.72  0.66 0.58  0.51 0.43  0.36 0.29  0.23 0.18  0.14 0.10  0.07 0.05  0.04 0.02  
12 0.93  0.90 0.86  0.80 0.74  0.67 0.59  0.52 0.44  0.36 0.29  0.23 0.18  0.13 0.10  0.07 0.05  0.03 0.02  
13 0.94  0.91 0.87  0.82 0.76  0.69 0.61  0.52 0.44  0.36 0.29  0.23 0.17  0.13 0.09  0.06 0.04  0.03 0.02  
14 0.95  0.92 0.88  0.83 0.77  0.70 0.62  0.53 0.45  0.37 0.29  0.22 0.17  0.12 0.08  0.06 0.04  0.02 0.01  
15 0.96  0.93 0.90  0.85 0.78  0.71 0.63  0.54 0.45  0.37 0.29  0.22 0.16  0.12 0.08  0.05 0.03  0.02 0.01  
16 0.97  0.94 0.91  0.86 0.80  0.72 0.64  0.55 0.46  0.37 0.29  0.22 0.16  0.11 0.08  0.05 0.03  0.02 0.01  
17 0.97  0.95 0.91  0.87 0.81  0.73 0.65  0.56 0.46  0.37 0.29  0.21 0.15  0.11 0.07  0.05 0.03  0.02 0.01  
18 0.97  0.95 0.92  0.88 0.82  0.74 0.66  0.56 0.47  0.37 0.29  0.21 0.15  0.10 0.07  0.04 0.03  0.01 0.01  
19 0.98  0.96 0.93  0.89 0.83  0.75 0.66  0.57 0.47  0.37 0.28  0.21 0.15  0.10 0.06  0.04 0.02  0.01 0.01  
20 0.98  0.96 0.94  0.89 0.84  0.76 0.67  0.57 0.47  0.37 0.28  0.20 0.14  0.09 0.06  0.04 0.02  0.01 0.01  
21 0.98  0.97 0.94  0.90 0.84  0.77 0.68  0.58 0.48  0.37 0.28  0.20 0.14  0.09 0.06  0.03 0.02  0.01 0.01  
22 0.99  0.97 0.95  0.91 0.85  0.78 0.69  0.58 0.48  0.37 0.28  0.20 0.13  0.09 0.05  0.03 0.02  0.01 0.00  
23 0.99  0.98 0.95  0.91 0.86  0.78 0.69  0.59 0.48  0.37 0.28  0.20 0.13  0.08 0.05  0.03 0.02  0.01 0.00  
24 0.99  0.98 0.96  0.92 0.87  0.79 0.70  0.60 0.48  0.37 0.28  0.19 0.13  0.08 0.05  0.03 0.01  0.01 0.00  
25 0.99  0.98 0.96  0.93 0.87  0.80 0.71  0.60 0.49  0.38 0.27  0.19 0.12  0.08 0.04  0.02 0.01  0.01 0.00  
26 0.99  0.98 0.96  0.93 0.88  0.81 0.71  0.60 0.49  0.38 0.27  0.19 0.12  0.07 0.04  0.02 0.01  0.01 0.00  
27 0.99  0.98 0.97  0.93 0.88  0.81 0.72  0.61 0.49  0.38 0.27  0.18 0.12  0.07 0.04  0.02 0.01  0.00 0.00  
28 0.99  0.99 0.97  0.94 0.89  0.82 0.72  0.61 0.49  0.38 0.27  0.18 0.11  0.07 0.04  0.02 0.01  0.00 0.00  
29 1.00  0.99 0.97  0.94 0.89  0.82 0.73  0.62 0.50  0.38 0.27  0.18 0.11  0.07 0.04  0.02 0.01  0.00 0.00  
30 1.00  0.99 0.97  0.95 0.90  0.83 0.74  0.62 0.50  0.38 0.27  0.18 0.11  0.06 0.03  0.02 0.01  0.00 0.00  
31 1.00  0.99 0.98  0.95 0.90  0.83 0.74  0.63 0.50  0.38 0.26  0.17 0.11  0.06 0.03  0.02 0.01  0.00 0.00  
32 1.00  0.99 0.98  0.95 0.91  0.84 0.75  0.63 0.50  0.38 0.26  0.17 0.10  0.06 0.03  0.01 0.01  0.00 0.00  
33 1.00  0.99 0.98  0.96 0.91  0.84 0.75  0.63 0.50  0.38 0.26  0.17 0.10  0.06 0.03  0.01 0.01  0.00 0.00  
34 1.00  0.99 0.98  0.96 0.92  0.85 0.75  0.64 0.51  0.38 0.26  0.17 0.10  0.05 0.03  0.01 0.01  0.00 0.00  
35 1.00  0.99 0.98  0.96 0.92  0.85 0.76  0.64 0.51  0.38 0.26  0.16 0.10  0.05 0.03  0.01 0.00  0.00 0.00  
36 1.00  0.99 0.98  0.96 0.92  0.86 0.76  0.64 0.51  0.38 0.26  0.16 0.09  0.05 0.02  0.01 0.00  0.00 0.00  
37 1.00  1.00 0.99  0.97 0.93  0.86 0.77  0.65 0.51  0.38 0.25  0.16 0.09  0.05 0.02  0.01 0.00  0.00 0.00  
38 1.00  1.00 0.99  0.97 0.93  0.87 0.77  0.65 0.51  0.37 0.25  0.16 0.09  0.05 0.02  0.01 0.00  0.00 0.00  
39 1.00  1.00 0.99  0.97 0.93  0.87 0.78  0.65 0.51  0.37 0.25  0.15 0.09  0.04 0.02  0.01 0.00  0.00 0.00  
40 1.00  1.00 0.99  0.97 0.94  0.87 0.78  0.66 0.52  0.37 0.25  0.15 0.08  0.04 0.02  0.01 0.00  0.00 0.00  
41 1.00  1.00 0.99  0.97 0.94  0.88 0.78  0.66 0.52  0.37 0.25  0.15 0.08  0.04 0.02  0.01 0.00  0.00 0.00  
42 1.00  1.00 0.99  0.98 0.94  0.88 0.79  0.66 0.52  0.37 0.25  0.15 0.08  0.04 0.02  0.01 0.00  0.00 0.00  
43 1.00  1.00 0.99  0.98 0.94  0.88 0.79  0.67 0.52  0.37 0.24  0.15 0.08  0.04 0.02  0.01 0.00  0.00 0.00  
44 1.00  1.00 0.99  0.98 0.95  0.89 0.79  0.67 0.52  0.37 0.24  0.14 0.08  0.04 0.02  0.01 0.00  0.00 0.00  
45 1.00  1.00 0.99  0.98 0.95  0.89 0.80  0.67 0.52  0.37 0.24  0.14 0.07  0.03 0.01  0.01 0.00  0.00 0.00  
46 1.00  1.00 0.99  0.98 0.95  0.89 0.80  0.67 0.52  0.37 0.24  0.14 0.07  0.03 0.01  0.01 0.00  0.00 0.00  
47 1.00  1.00 0.99  0.98 0.95  0.90 0.81  0.68 0.53  0.37 0.24  0.14 0.07  0.03 0.01  0.00 0.00  0.00 0.00  
48 1.00  1.00 0.99  0.98 0.96  0.90 0.81  0.68 0.53  0.37 0.24  0.13 0.07  0.03 0.01  0.00 0.00  0.00 0.00  
49 1.00  1.00 1.00  0.98 0.96  0.90 0.81  0.68 0.53  0.37 0.24  0.13 0.07  0.03 0.01  0.00 0.00  0.00 0.00  
50 1.00  1.00 1.00  0.98 0.96  0.91 0.81  0.69 0.53  0.37 0.23  0.13 0.07  0.03 0.01  0.00 0.00  0.00 0.00  
60 1.00  1.00 1.00  0.99 0.97  0.93 0.84  0.71 0.54  0.37 0.22  0.11 0.05  0.02 0.01  0.00 0.00  0.00 0.00  
70 1.00  1.00 1.00  1.00 0.98  0.94 0.86  0.73 0.55  0.36 0.21  0.10 0.04  0.01 0.00  0.00 0.00  0.00 0.00  
80 1.00  1.00 1.00  1.00 0.99  0.96 0.88  0.75 0.56  0.36 0.19  0.09 0.03  0.01 0.00  0.00 0.00  0.00 0.00  
90 1.00  1.00 1.00  1.00 0.99  0.97 0.90  0.76 0.57  0.36 0.18  0.08 0.03  0.01 0.00  0.00 0.00  0.00 0.00  
100 1.00  1.00 1.00  1.00 0.99  0.97 0.91  0.78 0.58  0.35 0.17  0.07 0.02  0.00 0.00  0.00 0.00  0.00 0.00  
110 1.00  1.00 1.00  1.00 1.00  0.98 0.92  0.79 0.58  0.35 0.16  0.06 0.02  0.00 0.00  0.00 0.00  0.00 0.00  
120 1.00  1.00 1.00  1.00 1.00  0.98 0.93  0.80 0.59  0.35 0.15  0.05 0.01  0.00 0.00  0.00 0.00  0.00 0.00  
130 1.00  1.00 1.00  1.00 1.00  0.99 0.94  0.82 0.60  0.34 0.15  0.05 0.01  0.00 0.00  0.00 0.00  0.00 0.00  
140 1.00  1.00 1.00  1.00 1.00  0.99 0.95  0.83 0.60  0.34 0.14  0.04 0.01  0.00 0.00  0.00 0.00  0.00 0.00  
150 1.00  1.00 1.00  1.00 1.00  0.99 0.95  0.84 0.61  0.33 0.13  0.04 0.01  0.00 0.00  0.00 0.00  0.00 0.00  
160 1.00  1.00 1.00  1.00 1.00  0.99 0.96  0.85 0.61  0.33 0.12  0.03 0.01  0.00 0.00  0.00 0.00  0.00 0.00  
170 1.00  1.00 1.00  1.00 1.00  1.00 0.97  0.85 0.62  0.33 0.12  0.03 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
180 1.00  1.00 1.00  1.00 1.00  1.00 0.97  0.86 0.62  0.32 0.11  0.02 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
190 1.00  1.00 1.00  1.00 1.00  1.00 0.97  0.87 0.63  0.32 0.11  0.02 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
200 1.00  1.00 1.00  1.00 1.00  1.00 0.98  0.88 0.63  0.32 0.10  0.02 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
300 1.00  1.00 1.00  1.00 1.00  1.00 0.99  0.92 0.67  0.29 0.06  0.01 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
400 1.00  1.00 1.00  1.00 1.00  1.00 1.00  0.95 0.70  0.27 0.04  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
500 1.00  1.00 1.00  1.00 1.00  1.00 1.00  0.97 0.72  0.24 0.03  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
600 1.00  1.00 1.00  1.00 1.00  1.00 1.00  0.98 0.74  0.23 0.02  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
700 1.00  1.00 1.00  1.00 1.00  1.00 1.00  0.99 0.76  0.21 0.01  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
800 1.00  1.00 1.00  1.00 1.00  1.00 1.00  0.99 0.78  0.20 0.01  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
900 1.00  1.00 1.00  1.00 1.00  1.00 1.00  0.99 0.79  0.18 0.00  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
1000 1.00  1.00 1.00  1.00 1.00  1.00 1.00  1.00 0.80  0.17 0.00  0.00 0.00  0.00 0.00  0.00 0.00  0.00 0.00  
];

% find column
if U>180
    col = min(size(rst_table));
 elseif U<90
    col = 2;
 else
    col = find(rst_table(1,:)>U) - 1;
end

% find row
if n>=1000
   row = max(size(rst_table));
elseif n>4
   row = find(rst_table(:,1)>n)-1;
else % n is 4
   row = 2;
end

%debug
%n,U,col,row

% and return cell value
p_value = rst_table(row(1),col(1));